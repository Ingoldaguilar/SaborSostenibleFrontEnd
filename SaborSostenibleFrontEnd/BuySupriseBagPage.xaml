<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="SaborSostenibleFrontEnd.BuySupriseBagPage"
             BackgroundColor="White"
             Title="Comprar Bolsa Sorpresa">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="25">

            <!-- Barra de progreso de pasos -->
            <Grid ColumnDefinitions="Auto,*,Auto,*,Auto" RowDefinitions="Auto,Auto" Padding="10,0,10,10">
                <!-- CÃ­rculo Paso 1 -->
                <Frame x:Name="Paso1Icon" BackgroundColor="#2E7D32" CornerRadius="15" HeightRequest="30" WidthRequest="30" HorizontalOptions="Center">
                    <Label Text="1" HorizontalOptions="Center" VerticalOptions="Center" TextColor="White" FontAttributes="Bold"/>
                </Frame>

                <!-- LÃ­nea entre paso 1 y 2 -->
                <BoxView Grid.Column="1" HeightRequest="2" BackgroundColor="#BDBDBD" VerticalOptions="Center"/>

                <!-- CÃ­rculo Paso 2 -->
                <Frame x:Name="Paso2Icon" BackgroundColor="#BDBDBD" CornerRadius="15" HeightRequest="30" WidthRequest="30" HorizontalOptions="Center">
                    <Label Text="2" HorizontalOptions="Center" VerticalOptions="Center" TextColor="White" FontAttributes="Bold"/>
                </Frame>

                <!-- LÃ­nea entre paso 2 y 3 -->
                <BoxView Grid.Column="3" HeightRequest="2" BackgroundColor="#BDBDBD" VerticalOptions="Center"/>

                <!-- CÃ­rculo Paso 3 -->
                <Frame x:Name="Paso3Icon" BackgroundColor="#BDBDBD" CornerRadius="15" HeightRequest="30" WidthRequest="30" HorizontalOptions="Center">
                    <Label Text="3" HorizontalOptions="Center" VerticalOptions="Center" TextColor="White" FontAttributes="Bold"/>
                </Frame>

                <!-- Etiquetas debajo -->
                <Label Grid.Row="1" Text="Confirmar" Grid.Column="0" HorizontalOptions="Center" FontSize="12" TextColor="#555"/>
                <Label Grid.Row="1" Text="Pago" Grid.Column="2" HorizontalOptions="Center" FontSize="12" TextColor="#555"/>
                <Label Grid.Row="1" Text="Final" Grid.Column="4" HorizontalOptions="Center" FontSize="12" TextColor="#555"/>
            </Grid>


            <!-- Imagen del restaurante (si aplica) -->
            <Image x:Name="RestauranteImagen" IsVisible="False"/>

            <!-- Paso 1: Confirmar Bolsa -->
            <StackLayout x:Name="Paso1" IsVisible="True" Spacing="25">

                <Label Text="ConfirmaciÃ³n de Bolsa" FontSize="26" FontAttributes="Bold" TextColor="#2C3E50" />

                <Frame BackgroundColor="#F5F5F5" CornerRadius="15" HasShadow="True" Padding="15">
                    <Grid ColumnDefinitions="Auto,*" ColumnSpacing="15">
                        <Image Source="{Binding Source={x:Reference RestauranteImagen}, Path=Source}" WidthRequest="70" HeightRequest="70" Aspect="AspectFill" 
                               Clip="RectangleGeometry RadiusX=10 RadiusY=10 Rect='0,0,70,70'" />
                        <VerticalStackLayout VerticalOptions="Center" Spacing="4">
                            <Label x:Name="RestauranteNombreLabel" FontSize="18" FontAttributes="Bold" TextColor="#2E7D32"/>
                            <Label x:Name="RestauranteDescripcionLabel" FontSize="14" TextColor="#777"/>
                            <Label x:Name="RestauranteTelefonoLabel" FontSize="13" TextColor="#999"/>
                        </VerticalStackLayout>
                    </Grid>
                </Frame>

                <Frame BackgroundColor="White" CornerRadius="12" Padding="15" HasShadow="True" BorderColor="#A5D6A7">
                    <VerticalStackLayout Spacing="10">
                        <Label x:Name="DescripcionBolsaLabel" FontSize="16" TextColor="#444" />
                        <Label x:Name="PrecioBolsaLabel" FontSize="20" FontAttributes="Bold" TextColor="#2E7D32" />
                    </VerticalStackLayout>
                </Frame>

                <!-- TelÃ©fono del cliente -->
                <Entry x:Name="CustomerPhoneEntry" Placeholder="Tu nÃºmero de telÃ©fono" Keyboard="Telephone"
                       BackgroundColor="#FAFAFA" TextColor="#2E7D32" FontSize="14" />

                <!-- DonaciÃ³n -->
                <Frame BackgroundColor="#E8F5E9" CornerRadius="12" Padding="10" HasShadow="False" BorderColor="#A5D6A7">
                    <Grid ColumnDefinitions="Auto,*,Auto" VerticalOptions="Center">
                        <Image Source="heart_icon.png" WidthRequest="24" HeightRequest="24" VerticalOptions="Center"/>
                        <Label Text="Â¿Deseas donar esta bolsa?" FontSize="15" TextColor="#2E7D32" VerticalOptions="Center" Padding="10,0"/>
                        <Switch x:Name="DonacionSwitch"
                                Toggled="OnDonacionToggled"
                                HorizontalOptions="End"
                                VerticalOptions="Center"/>
                    </Grid>
                </Frame>

                <Picker x:Name="FoodBankPicker"
                        Title="Selecciona un banco de comida"
                        IsVisible="False"
                        BackgroundColor="#FAFAFA"
                        TextColor="#2E7D32"
                        TitleColor="#2E7D32"
                        FontSize="14"
                        Margin="0,5"/>

                <Button Text="Proceder con Compra"
                        Clicked="OnProcederCompraClicked"
                        BackgroundColor="#2E7D32"
                        TextColor="White"
                        FontAttributes="Bold"
                        CornerRadius="12"
                        HeightRequest="50"
                        FontSize="16"/>
            </StackLayout>

            <!-- Paso 2: Instrucciones -->
            <Frame x:Name="InstruccionesStep"
                   IsVisible="False"
                   BackgroundColor="#F1F8E9"
                   CornerRadius="15"
                   Padding="15"
                   HasShadow="True"
                   BorderColor="#C5E1A5">
                <VerticalStackLayout Spacing="15">
                    <Label Text="Instrucciones de Pago" FontSize="22" FontAttributes="Bold" TextColor="#2C3E50" />

                    <Label Text="Monto a pagar:" FontSize="16" TextColor="#555" />
                    <Label x:Name="PagoMontoLabel" Text="â‚¡5,000" FontSize="18" FontAttributes="Bold" TextColor="#2E7D32" />

                    <Label Text="NÃºmero SINPE:" FontSize="16" TextColor="#555" />
                    <Label x:Name="PagoTelefonoLabel" FontSize="16" TextColor="#2E7D32" />

                    <Label Text="Detalle del pago:" FontSize="16" TextColor="#555" />
                    <Frame BackgroundColor="White" BorderColor="#A5D6A7" CornerRadius="8" Padding="10" HasShadow="False">
                        <Grid ColumnDefinitions="*,Auto">
                            <Label x:Name="SinpeDetalleLabel" Text="Pago bolsa sorpresa..." TextColor="#444" VerticalOptions="Center"/>
                            <ImageButton Source="copy_icon.png" Clicked="OnCopiarDetalleClicked" WidthRequest="24" HeightRequest="24"/>
                        </Grid>
                    </Frame>

                    <Button Text="Continuar"
                            Clicked="OnFinalizarClicked"
                            BackgroundColor="#2E7D32"
                            TextColor="White"
                            FontAttributes="Bold"
                            CornerRadius="12"
                            HeightRequest="48"/>
                </VerticalStackLayout>
            </Frame>

            <!-- Paso 3: ConfirmaciÃ³n -->
            <StackLayout x:Name="ConfirmacionStep" IsVisible="False" Spacing="20">
                <Label Text="Compra Finalizada" FontSize="24" FontAttributes="Bold" TextColor="#2C3E50"/>
                <Label x:Name="OrdenFinalLabel" FontSize="16" TextColor="#000"/>
                <Label x:Name="TelefonoFinalLabel" FontSize="16" TextColor="#000"/>
                <Label Text="Gracias por tu compra ðŸŽ‰" FontSize="16" TextColor="#2E7D32"/>

                <Button Text="Volver al Inicio"
                        Clicked="OnVolverInicioClicked"
                        BackgroundColor="#607D8B"
                        TextColor="White"
                        CornerRadius="10"/>
            </StackLayout>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
